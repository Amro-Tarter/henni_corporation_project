// src/pages/FormsPage.jsx
import React, { useState } from 'react'; // Removed useRef, as it's not strictly needed for docx simple text generation
import DashboardLayout from "../../components/dashboard/DashboardLayout";
import { FileText, Download } from 'lucide-react';
import { saveAs } from 'file-saver';
import { Document, Paragraph, TextRun, Packer, AlignmentType } from 'docx'; // All necessary imports for DOCX

const formsData = [
  {
    id: 'form1',
    title: '×˜×•×¤×¡ ×§×œ×™×˜×” ×œ×¢××•×ª×ª ×ª×œ×’×œ×•×ª ××ª ×”××•×¨',
    content: `×˜×•×¤×¡ ×§×œ×™×˜×” ×œ×¢××•×ª×ª ×ª×œ×’×œ×•×ª ××ª ×”××•×¨
×¤×¨×˜×™ ×”×™×œ×“/×” ×•×”××©×¤×—×”
×¤×¨×˜×™× ××™×©×™×™×
×©× ×¤×¨×˜×™: _________________ ×©× ××©×¤×—×”: _________________

×ª××¨×™×š ×œ×™×“×”: //______ ×’×™×œ: _____ ××™×Ÿ: â–¡ ×–×›×¨ â–¡ × ×§×‘×”

×›×ª×•×‘×ª ××’×•×¨×™×: _________________________________________________

×¢×™×¨: _____________ ××™×§×•×“: _________

×‘×™×ª ×¡×¤×¨: _________________________ ×›×™×ª×”: _____

×¤×¨×˜×™ ×”×•×¨×™×/××¤×•×˜×¨×•×¤×•×¡
×©× ×”×”×•×¨×”/××¤×•×˜×¨×•×¤×•×¡ ×”×¨××©×™: _____________________________

×§×¨×‘×ª ××©×¤×—×”: â–¡ ×× â–¡ ××‘ â–¡ ×¡×‘×/×¡×‘×ª× â–¡ ×“×•×“/×“×•×“×” â–¡ ××¤×•×˜×¨×•×¤×•×¡ ××—×¨: _______

×˜×œ×¤×•×Ÿ × ×™×™×“: _____________ ×˜×œ×¤×•×Ÿ ×‘×™×ª: _____________

××™××™×™×œ: _________________________________

××§×¦×•×¢: _________________ ××§×•× ×¢×‘×•×“×”: _________________

×©× ×”×•×¨×” ×©× ×™ (×× ×¨×œ×•×•× ×˜×™): _____________________________

×˜×œ×¤×•×Ÿ × ×™×™×“: _____________ ××™××™×™×œ: _________________

××¦×‘ ××©×¤×—×ª×™ ×•×¨×§×¢
××¦×‘ ×–×•×’×™ ×©×œ ×”×”×•×¨×™×: â–¡ × ×©×•××™× â–¡ ×’×¨×•×©×™× â–¡ ××œ××Ÿ/×” â–¡ ×¨×•×•×§×™× â–¡ ××—×¨: _______

××¡×¤×¨ ×™×œ×“×™× ×‘××©×¤×—×”: _____ ××™×§×•× ×”×™×œ×“/×” ×‘×™×Ÿ ×”××—×™×: _____

×©×¤×•×ª ×”×“×™×‘×•×¨ ×‘×‘×™×ª: _____________________________

××¦×‘ ×›×œ×›×œ×™ ××©×¤×—×ª×™: â–¡ ××¢×œ ×”×××•×¦×¢ â–¡ ×××•×¦×¢ â–¡ ××ª×—×ª ×œ×××•×¦×¢ â–¡ ×§×©×™×™× ×›×œ×›×œ×™×™×

×¤×¨×˜×™× ×¨×¤×•××™×™× ×•×¤×™×–×™×™×
×”×× ×™×© ×œ×™×œ×“/×” ×‘×¢×™×•×ª ×‘×¨×™××•×ª×™×•×ª ×›×¨×•× ×™×•×ª? â–¡ ×›×Ÿ â–¡ ×œ×

×× ×›×Ÿ, ×¤×¨×˜×•: _______________________________________________

×”×× ×”×™×œ×“/×” × ×•×˜×œ/×ª ×ª×¨×•×¤×•×ª ×‘××•×¤×Ÿ ×§×‘×•×¢? â–¡ ×›×Ÿ â–¡ ×œ×

×× ×›×Ÿ, ××™×œ×• ×ª×¨×•×¤×•×ª ×•×œ××”: ___________________________________

×”×× ×™×© ××œ×¨×’×™×•×ª? â–¡ ×›×Ÿ â–¡ ×œ×

×× ×›×Ÿ, ×¤×¨×˜×•: _______________________________________________

×”×× ×™×© ××•×’×‘×œ×•×™×•×ª ×¤×™×–×™×•×ª ××• ×§×©×™×™ ×œ××™×“×” ×××•×‘×—× ×™×? â–¡ ×›×Ÿ â–¡ ×œ×

×× ×›×Ÿ, ×¤×¨×˜×•: _______________________________________________

×¨×§×¢ ×¨×’×©×™ ×•××™×©×™×•×ª×™
×ª××¨×• ××ª ××™×©×™×•×ª ×”×™×œ×“/×”: (×‘×™×™×©×Ÿ/×™×ª, ×—×‘×¨×•×ª×™/×ª, ×× ×¨×’×˜×™/×ª, ×¨×’×™×©/×” ×•×›×•')

×”×× ×”×™×œ×“/×” ××˜×•×¤×œ/×ª ××¦×œ ×¤×¡×™×›×•×œ×•×’/×¢×•×‘×“ ×¡×•×¦×™××œ×™/×™×•×¢×¥? â–¡ ×›×Ÿ â–¡ ×œ×

×× ×›×Ÿ, ×¤×¨×˜×• ×¢×œ ×”×˜×™×¤×•×œ ×•×”×¡×™×‘×”: ________________________________

×”×× ×”×™×• ××™×¨×•×¢×™× ××©××¢×•×ª×™×™× ×‘×—×™×™ ×”×™×œ×“/×”? (××—×œ×”, ××•×•×ª ×‘××©×¤×—×”, ×’×™×¨×•×©×™×Ÿ, ××¢×‘×¨ ×“×™×¨×” ×•×›×•')

×¢× ×™×™×Ÿ ×‘××× ×•×ª ×•×›×™×©×¨×•× ×•×ª
×‘××™×œ×• ×ª×—×•××™ ××× ×•×ª ×”×™×œ×“/×” ××’×œ×” ×¢× ×™×™×Ÿ? (× ×™×ª×Ÿ ×œ×¡××Ÿ ×›××”)

â–¡ ×ª×™××˜×¨×•×Ÿ/××©×—×§ â–¡ ××•×–×™×§×”/×©×™×¨×” â–¡ ××—×•×œ/×ª× ×•×¢×” â–¡ ××× ×•×ª ×—×–×•×ª×™×ª â–¡ ×›×ª×™×‘×” ×™×•×¦×¨×ª

×”×× ×”×™×œ×“/×” ×œ××“/×” ×‘×¢×‘×¨ ×ª×—×•××™ ××× ×•×ª? â–¡ ×›×Ÿ â–¡ ×œ×

×× ×›×Ÿ, ×¤×¨×˜×•: _______________________________________________

×ª××¨×• ×›×™×©×¨×•× ×•×ª ××™×•×—×“×™× ×©×œ ×”×™×œ×“/×”: ____________________________

××” ×”×™×œ×“/×” ×”×›×™ ××•×”×‘/×ª ×œ×¢×©×•×ª ×‘×–××Ÿ ×”×¤× ×•×™? ________________________

××˜×¨×•×ª ×•×¦×™×¤×™×•×ª
××” ×”×¡×™×‘×” ×œ×”×¦×˜×¨×¤×•×ª ×œ×¢××•×ª×”? (× ×™×ª×Ÿ ×œ×¡××Ÿ ×›××”)

â–¡ ×¤×™×ª×•×— ×™×›×•×œ×•×ª ××× ×•×ª×™×•×ª â–¡ ×—×™×–×•×§ ×‘×™×˜×—×•×Ÿ ×¢×¦××™ â–¡ ×¤×™×ª×•×— ×›×™×©×•×¨×™× ×—×‘×¨×ª×™×™× â–¡ ×”×¢×©×¨×” ×ª×¨×‘×•×ª×™×ª â–¡ ××ª×Ÿ ××¡×’×¨×ª ×ª×•××›×ª â–¡ ××—×¨: ________________

××” ×”×¦×™×¤×™×•×ª ×©×œ×›× ××”×¢××•×ª×”?

×”×× ×™×© ××©×”×• ××™×•×—×“ ×©×—×©×•×‘ ×œ× ×• ×œ×“×¢×ª ×¢×œ ×”×™×œ×“/×”?

×¤×¨×˜×™× × ×•×¡×¤×™×
××™×š ×©××¢×ª× ×¢×œ ×”×¢××•×ª×”?

â–¡ ×”××œ×¦×” ××—×‘×¨/×‘×Ÿ ××©×¤×—×” â–¡ ×¨×©×ª×•×ª ×—×‘×¨×ª×™×•×ª â–¡ ×‘×™×ª ×¡×¤×¨ â–¡ ××ª×¨ ××™× ×˜×¨× ×˜ â–¡ ××—×¨: _______

×”×× ×ª×•×›×œ×• ×œ×”×’×™×¢ ×œ×¤×¢×™×œ×•×™×•×ª ×‘××•×¤×Ÿ ×§×‘×•×¢? â–¡ ×›×Ÿ â–¡ ×œ× ×‘×˜×•×— â–¡ ×œ×

×”×× ×™×© ×œ×›× ×“×¨×™×©×•×ª ××™×•×—×“×•×ª ×œ×”×¡×¢×•×ª? â–¡ ×›×Ÿ â–¡ ×œ×

×× ×›×Ÿ, ×¤×¨×˜×•: _______________________________________________

×”×¡×›××•×ª ×•×”×¦×”×¨×•×ª
â–¡ ×× ×™ ××¡×›×™×/×” ×©×”×¢××•×ª×” ×ª×™×¦×•×¨ ×§×©×¨ ×¢× ×’×•×¨××™× ×¨×œ×•×•× ×˜×™×™× (×‘×™×ª ×¡×¤×¨, ××˜×¤×œ×™× ×•×›×•') ×‘××™×“×ª ×”×¦×•×¨×š

â–¡ ×× ×™ ××¡×›×™×/×” ×œ×¦×™×œ×•× ×”×™×œ×“/×” ×œ×¦×¨×›×™ ×ª×™×¢×•×“ ×•×¤×¨×¡×•× ×©×œ ×”×¢××•×ª×” (×œ×œ× ×¤×¨×¡×•× ×©××•×ª)

â–¡ ×× ×™ ××ª×—×™×™×‘/×ª ×œ×”×•×“×™×¢ ×¢×œ ×©×™× ×•×™×™× ×‘××¦×‘ ×”×‘×¨×™××•×ª×™ ××• ×”××™×©×™ ×©×œ ×”×™×œ×“/×”

â–¡ ×× ×™ ×××©×¨/×ª ×©×›×œ ×”××™×“×¢ ×©××¡×¨×ª×™ × ×›×•×Ÿ ×•××“×•×™×§

×©× ×—×•×ª× ×©×œ ×”×”×•×¨×”/××¤×•×˜×¨×•×¤×•×¡: _____________________________

×—×ª×™××”: _____________ ×ª××¨×™×š: //______

×¨×§ ×œ××™×œ×•×™ ×¦×•×•×ª ×”×¢××•×ª×”:

×ª××¨×™×š ×§×‘×œ×ª ×”×˜×•×¤×¡: //______ ××™ ×§×™×‘×œ: _____________

×”×¢×¨×•×ª ×¦×•×•×ª: _______________________________________________

××•×©×¨ ×œ×§×‘×œ×”: â–¡ ×›×Ÿ â–¡ ×œ× ×ª××¨×™×š ×ª×—×™×œ×ª ×¤×¢×™×œ×•×ª: //______
`,
    fileName: '×˜×•×¤×¡_×§×œ×™×˜×”_×œ×¢××•×ª×ª_×œ×’×œ×•×ª_××ª_×”××•×¨.docx' // Changed to .docx
  },
  {
    id: 'form2',
    title: '×©××œ×•×Ÿ ×”×›× ×” ×œ×× ×˜×•×¨×™×•×ª',
    content: `×©××œ×•×Ÿ ×”×›× ×” ×œ×× ×˜×•×¨×™×•×ª
×¢××•×ª×ª ×ª×œ×’×œ×•×ª ××ª ×”××•×¨
×©× ×”×™×œ×“/×”: _________________ ×ª××¨×™×š: //______

×”×•×¨×™× ×™×§×¨×™×,

×›×“×™ ×©×”×× ×˜×•×¨ ×™×•×›×œ ×œ×”×›×™×Ÿ ××¤×’×© ××•×ª×× ×•××•×¢×™×œ ×¢×‘×•×¨×›×, ×× × ××œ××• ××ª ×”×©××œ×•×Ÿ ×”×§×¦×¨ ×”×–×” ×•×©×œ×—×• ××•×ª×• 2-3 ×™××™× ×œ×¤× ×™ ×”××¤×’×©.

1. ××¦×‘ ×”×™×œ×“/×” ×”×©×‘×•×¢×•×ª ×”××—×¨×•× ×™×
××™×š ×”×™×œ×“/×” ××¨×’×™×©/×” ×œ××—×¨×•× ×”? â–¡ ×××•×©×¨/×ª ×•×× ×¨×’×˜×™/×ª â–¡ ×¨×’×•×¢/×” ×•×××•×–×Ÿ/×ª â–¡ ×§×¦×ª ×¢×¦×•×‘/×” ××• ××ª×•×—/×” â–¡ ××©×ª× ×” ×”×¨×‘×”

×©×™× ×•×™×™× ×©×”×‘×—× ×ª× ×‘×”× ×‘×–××Ÿ ×”××—×¨×•×Ÿ: (×”×ª× ×”×’×•×ª, ××¦×‘ ×¨×•×—, ×”×¨×’×œ×™ ×©×™× ×”, ×ª×™××‘×•×Ÿ ×•×›×•')

×”×× ×§×¨×” ××©×”×• ××™×•×—×“ ×‘×‘×™×ª/×‘×‘×™×ª ×¡×¤×¨/×‘×—×™×™× ×©×œ×•/×”?

2. ×”×§×©×¨ ×¢× ×”×¢××•×ª×”
××™×š ×”×™×œ×“/×” ××¡×¤×¨/×ª ×¢×œ ×”×¤×¢×™×œ×•×™×•×ª ×‘×¢××•×ª×”? â–¡ ××ª×œ×”×‘/×ª ×•××¡×¤×¨/×ª ×”×¨×‘×” â–¡ ××•×”×‘/×ª ××‘×œ ×œ× ××¡×¤×¨/×ª ×”×¨×‘×” â–¡ ××ª×œ×•× ×Ÿ/×ª ×œ×¤×¢××™× â–¡ ×œ× ××•×”×‘/×ª ×œ×“×‘×¨ ×¢×œ ×–×”

×“×‘×¨×™× ×©×”×™×œ×“/×” ×”×›×™ ××•×”×‘/×ª ×‘×¢××•×ª×”:

×“×‘×¨×™× ×©×’×•×¨××™× ×œ×•/×” ×§×•×©×™ ××• ××ª×—:

3. ××” ××ª× ×¨×•×¦×™× ×œ×“×•×Ÿ ×¢×œ×™×•
×‘×—×¨×• ×¢×“ 3 × ×•×©××™× ×©×”×›×™ ×—×©×•×‘×™× ×œ×›× ×œ×“×‘×¨ ×¢×œ×™×”×: (×¡×× ×• âœ“)

â–¡ ×”×ª×§×“××•×ª ×”×™×œ×“/×” ×‘×ª×—×•× ×”××× ×•×ª×™ â–¡ ×”×ª×¤×ª×—×•×ª ×—×‘×¨×ª×™×ª ×•×™×—×¡×™× ×¢× ×™×œ×“×™× ××—×¨×™× â–¡ ×‘× ×™×™×ª ×‘×™×˜×—×•×Ÿ ×¢×¦××™ â–¡ ×”×ª××•×“×“×•×ª ×¢× ×§×©×™×™× ××• ××ª×’×¨×™× â–¡ ×”×ª× ×”×’×•×ª ×©×œ ×”×™×œ×“/×” ×‘×‘×™×ª â–¡ ×¢×‘×•×“×ª ×©×™×ª×•×£ ×¢× ×‘×™×ª ×”×¡×¤×¨ â–¡ ×™×¢×“×™× ×œ×ª×§×•×¤×” ×”×§×¨×•×‘×” â–¡ ×“×¨×›×™× ×©××ª× ×™×›×•×œ×™× ×œ×¢×–×•×¨ ×‘×‘×™×ª â–¡ ××—×¨: ________________________________

×”×©××œ×” ×”×›×™ ×—×©×•×‘×” ×©×¨×¦×™×ª× ×œ×©××•×œ:

4. ×”××•×•×™×¨×” ×‘×‘×™×ª
××™×š ×”×™×œ×“/×” ××ª× ×”×’/×ª ×‘×‘×™×ª ×”×©×‘×•×¢×•×ª ×”××—×¨×•× ×™×? â–¡ ×©×™×ª×•×¤×™/×ª ×•× ×¢×™×/×” â–¡ ×¨×’×™×œ/×” ×›××• ×ª××™×“ â–¡ ×§×¦×ª ×¢×¦×‘× ×™/×ª ××• ×¢×§×©×Ÿ/×™×ª â–¡ ×¡×’×•×¨/×” ×•×©×§×˜/×” â–¡ ××©×ª× ×” ×œ×¤×™ ×”×™×•×

×”×× ×™×© ×“×‘×¨×™× ×©×’×•×¨××™× ×‘××™×•×—×“ ×œ×¢×™××•×ª×™× ××• ×§×•×©×™?

×“×‘×¨×™× ×©××©××—×™× ××ª ×”×™×œ×“/×” ×‘×–××Ÿ ×”××—×¨×•×Ÿ:

5. ×‘×§×©×•×ª ××™×•×—×“×•×ª
×”×× ×™×© × ×•×©× ×¨×’×™×© ×©×—×©×•×‘ ×©×”×× ×˜×•×¨ ×™×“×¢ ×¢×œ×™×•? (×’×™×¨×•×©×™×Ÿ, ××—×œ×” ×‘××©×¤×—×”, ×§×©×™×™× ×›×œ×›×œ×™×™×, ×‘×¢×™×•×ª ×‘×‘×™×ª ×¡×¤×¨ ×•×›×•')

××™×š ××ª× ××¢×“×™×¤×™× ×©×”×× ×˜×•×¨ ×™×’×™×© ×œ×™×œ×“/×” ×¢×¦×•×ª ××• ×‘×™×§×•×¨×ª? â–¡ ×™×©×™×¨×•×ª ×•×‘×¨×•×¨ â–¡ ×‘×¢×“×™× ×•×ª ×•×‘×”×“×¨×’×” â–¡ ×“×¨×š ×¡×™×¤×•×¨×™× ×•×“×•×’×××•×ª â–¡ ×‘×”×•××•×¨

×”×× ×™×© ×“×‘×¨×™× ×©×”×™×œ×“/×” ×œ× ××•×”×‘/×ª ×œ×©××•×¢ ××• ×©×’×•×¨××™× ×œ×•/×” ×œ×¡×’×™×¨×•×ª?

6. ××˜×¨×•×ª ×œ×©×™×—×”
××” ××ª× ×”×›×™ ××§×•×•×™× ×œ×§×‘×œ ××”×©×™×—×” ×”×–××ª? â–¡ ×”×‘× ×ª ×”××¦×‘ ×”× ×•×›×—×™ ×©×œ ×”×™×œ×“/×” â–¡ ×›×œ×™× ××¢×©×™×™× ×œ×˜×™×¤×•×œ ×‘×‘×¢×™×•×ª â–¡ ×¢×™×“×•×“ ×•×—×™×–×•×§ ×©××ª× ×‘×“×¨×š ×”× ×›×•× ×” â–¡ ×™×¢×“×™× ×‘×¨×•×¨×™× ×œ×ª×§×•×¤×” ×”×§×¨×•×‘×” â–¡ ×”×›× ×” ×œ××™×¨×•×¢ ××• ×©×™× ×•×™ ××ª×•×›× ×Ÿ â–¡ ××—×¨: ________________________________

×‘×¡×™×•× ×”×©×™×—×”, ××™×š ×ª×“×¢×• ×©×”×™× ×”×™×™×ª×” ××•×¦×œ×—×ª ×¢×‘×•×¨×›×?

7. ×¤×¨×˜×™× ××¢×©×™×™×
×¢×“×™×¤×•×ª ×–××Ÿ ×œ×©×™×—×”: â–¡ ×‘×•×§×¨ â–¡ ×¦×”×¨×™×™× â–¡ ××—×¨ ×”×¦×”×¨×™×™× â–¡ ×¢×¨×‘

××™×š ××¢×“×™×¤×™× ×œ×§×™×™× ××ª ×”×©×™×—×”? â–¡ ×¤×’×™×©×” ×¤×™×–×™×ª â–¡ ×–×•×/×©×™×—×ª ×•×™×“××• â–¡ ×©×™×—×ª ×˜×œ×¤×•×Ÿ

××©×š ×–××Ÿ ××•×¢×“×£: â–¡ 30 ×“×§×•×ª â–¡ 45 ×“×§×•×ª â–¡ ×©×¢×” â–¡ ×™×•×ª×¨ ×× × ×“×¨×©

×”×× ×ª×¨×¦×• ×©×”×™×œ×“/×” ×™×”×™×”/×ª×”×™×” ×—×œ×§ ××”×©×™×—×”? â–¡ ×›×Ÿ, ×›×œ ×”×©×™×—×” â–¡ ×›×Ÿ, ×—×œ×§ ××”×©×™×—×” â–¡ ×œ×, ×¨×§ ×”×”×•×¨×™×

×ª×•×“×” ×¨×‘×” ×¢×œ ×”×–××Ÿ ×•×”××—×©×‘×”! ×”×ª×©×•×‘×•×ª ×©×œ×›× ×™×¢×–×¨×• ×œ× ×• ×œ×”×›×™×Ÿ ×©×™×—×” ××•×¢×™×œ×ª ×•××•×ª×××ª ×¢×‘×•×¨×›×.

×©× ×”×”×•×¨×” ×”×××œ×: _________________ ×—×ª×™××”: _____________ ×ª××¨×™×š: //______

×× × ×©×œ×—×• ××ª ×”×©××œ×•×Ÿ ×”××œ× ×œ: [××™××™×™×œ] ××• ×•×•××˜×¡××¤: [××¡×¤×¨] ×œ×¤×—×•×ª ×™×•××™×™× ×œ×¤× ×™ ×”×¤×’×™×©×”
`,
    fileName: '×©××œ×•×Ÿ_×”×›× ×”_×œ×× ×˜×•×¨×™×•×ª.docx' // Changed to .docx
  },
  {
    id: 'form3',
    title: '×“×™×•×•×— ×× ×˜×•×¨ ×œ××©×¤×—×”',
    content: `×“×™×•×•×— ×× ×˜×•×¨ ×œ××©×¤×—×”
×¢××•×ª×ª ×ª×œ×’×œ×•×ª ××ª ×”××•×¨
×©× ×”×™×œ×“/×”: _________________ ×ª××¨×™×š ×”×“×™×•×•×—: //______

×©× ×”×× ×˜×•×¨: _________________ ×ª×§×•×¤×ª ×”×“×™×•×•×—: _________________

××©×¤×—×” ×™×§×¨×”,

×× ×• ×©××—×™× ×œ×—×œ×•×§ ×¢××›× ××ª ×”×”×ª×¤×ª×—×•×ª ×•×”×¢×©×™×” ×©×œ ×™×œ×“×›×/×™×œ×“×ª×›× ×”×™×§×¨/×” ×‘×¢××•×ª×”. ×“×™×•×•×— ×–×” × ×›×ª×‘ ×‘××˜×¨×” ×œ×©×ª×£ ×•×œ×©××•×¨ ×¢×œ ×§×©×¨ ×”×“×•×§ ×‘×™× × ×•.

×”×ª×§×“××•×ª ×‘×ª×—×•× ×”××× ×•×ª×™
×”×ª×—×•× ×”×¨××©×™: ________________________
××” ×”×™×œ×“/×” ×œ××“/×” ×”×©×‘×•×¢/×—×•×“×©:

×›×™×©×•×¨×™× ×—×“×©×™× ×©×¨×›×©/×”: â–¡ ×©×™×¤×•×¨ ×‘×‘×™×˜×—×•×Ÿ ×¢×¦××™ ×‘×”×•×¤×¢×” â–¡ ×¤×™×ª×•×— ×™×›×•×œ×•×ª ×˜×›× ×™×•×ª â–¡ ×™×¦×™×¨×ª×™×•×ª ××•×’×‘×¨×ª â–¡ ×©×™×ª×•×£ ×¤×¢×•×œ×” ×˜×•×‘ ×™×•×ª×¨ ×¢× ×”×§×‘×•×¦×” â–¡ ××—×¨: ________________________________________________

×”×™×©×’×™× ××™×•×—×“×™×:

×”×ª×¤×ª×—×•×ª ××™×©×™×ª ×•×—×‘×¨×ª×™×ª
×™×—×¡×™× ×—×‘×¨×ª×™×™×:
×›×™×¦×“ ×”×™×œ×“/×” ××ª× ×”×’/×ª ×‘×§×‘×•×¦×”: â–¡ ××•×‘×™×œ/×” ×•×™×•×–×/×ª â–¡ ××©×ª×ª×£/×ª ×‘×¤×¢×™×œ×•×ª â–¡ ×–×§×•×§/×” ×œ×¢×™×“×•×“ â–¡ ××ª×‘×•×“×“/×ª ×œ×¤×¢××™×

×—×‘×¨×•×™×•×ª ×©× ×•×¦×¨×•:

×‘×™×˜×—×•×Ÿ ×¢×¦××™:
×©×™× ×•×™×™× ×©×”×‘×—× ×• ×‘×”×: â–¡ ×™×•×ª×¨ ×¤×ª×•×—/×” ×œ× ×¡×•×ª ×“×‘×¨×™× ×—×“×©×™× â–¡ ××‘×™×¢/×” ×“×¢×•×ª ×•×—×•×•×ª ×“×¢×ª â–¡ ×¤×—×•×ª ××ª×‘×™×™×©/×ª ×œ×”×•×¤×™×¢ ××•×œ ××—×¨×™× â–¡ ××¨××” ×™×•×ª×¨ ×’××•×•×” ×‘×¢×‘×•×“×ª×•/×” â–¡ ××—×¨: ________________________________________________

××ª×’×¨×™× ×•×§×©×™×™×
×ª×—×•××™× ×©×“×•×¨×©×™× ×ª×©×•××ª ×œ×‘:

×”××•×¤×Ÿ ×©×‘×• ×× ×• ××ª××•×“×“×™× ×¢× ×”××ª×’×¨×™×:

××™×š ×ª×•×›×œ×• ×œ×¢×–×•×¨ ×‘×‘×™×ª: â€¢ _______________________________________________________________ â€¢ _______________________________________________________________ â€¢ _______________________________________________________________

×”××œ×¦×•×ª ×œ××©×¤×—×”
×¤×¢×™×œ×•×™×•×ª ×œ×¢×™×“×•×“ ×‘×‘×™×ª:
â–¡ ×”××–× ×” ×œ××•×–×™×§×” ××’×•×•× ×ª ×™×—×“ â–¡ ×¦×¤×™×™×” ×‘×”×¦×’×•×ª ××• ×¡×¨×˜×™× â–¡ ×™×¦×™×¨×” ××©×•×ª×¤×ª (×¦×™×•×¨, ×›×ª×™×‘×”, ×•×›×•') â–¡ ×¢×™×“×•×“ ×œ×”×•×¤×™×¢ ×‘×¤× ×™ ×”××©×¤×—×” â–¡ ×©×™×—×•×ª ×¢×œ ×—×•×•×™×•×ª ××”×¢××•×ª×” â–¡ ××—×¨: ________________________________________________

×“×‘×¨×™× ×—×©×•×‘×™× ×œ×–×›×•×¨:
×¢×™×“×•×“ ×—×™×•×‘×™: _______________________________________________ ×ª××™×›×” ×¨×’×©×™×ª: ______________________________________________ ×¡×‘×œ× ×•×ª ×¢× ×”×ª×”×œ×™×š: _________________________________________

×ª×•×›× ×™×•×ª ×œ×ª×§×•×¤×” ×”×§×¨×•×‘×”
×™×¢×“×™× ×œ×—×•×“×© ×”×‘×:

×¤×¢×™×œ×•×™×•×ª ××™×•×—×“×•×ª ××ª×•×›× × ×•×ª: â–¡ ×”×›× ×” ×œ×”×•×¤×¢×” â–¡ ×¡×“× ×ª ×™×¦×™×¨×” â–¡ ×¤×¨×•×™×§×˜ ×§×‘×•×¦×ª×™ â–¡ ×ª×—×¨×•×ª/×¤×¡×˜×™×‘×œ â–¡ ××—×¨: ________________________________________________

××™×¨×•×¢×™× ×©×›×“××™ ×©×ª×“×¢×• ×¢×œ×™×”×:

×¦×¨×›×™× ×•×‘×§×©×•×ª
×”×× ×™×© ××©×”×• ×©×—×©×•×‘ ×©× ×“×¢ ×¢×œ ×”×™×œ×“/×”? (×©×™× ×•×™×™× ×‘×‘×™×ª, ××™×¨×•×¢×™× ××™×•×—×“×™×, ×§×©×™×™× ×—×“×©×™× ×•×›×•')

×”×× ×™×© ×œ×›× ×©××œ×•×ª ××• ×‘×§×©×•×ª ××œ×™× ×•?

×”×× ×ª×¨×¦×• ×œ×§×‘×•×¢ ×¤×’×™×©×” ××™×©×™×ª? â–¡ ×›×Ÿ â–¡ ×œ×

×¨×’×¢ ×©×œ ×’××•×•×” ğŸŒŸ
×”×¨×’×¢ ×”×›×™ ×™×¤×” ×”×©×‘×•×¢/×—×•×“×© ×¢× ×”×™×œ×“/×” ×©×œ×›×:

××” ×”×™×œ×“/×” ×××¨/×” ×©×’×¨× ×œ× ×• ×œ×”×ª×¨×’×©:

×¤×¨×˜×™ ×§×©×¨ ×œ××¢×§×‘
×“×¨×›×™× ×œ×™×¦×™×¨×ª ×§×©×¨:

×˜×œ×¤×•×Ÿ: _________________ (×‘×™×Ÿ ×”×©×¢×•×ª _____ - _____)
×•×•××˜×¡××¤: _________________
××™××™×™×œ: _________________
×–××™× ×•×ª ×œ×©×™×—×•×ª: â–¡ ×‘×ª×™××•× ××¨××© â–¡ ×—×™×¨×•× ×‘×œ×‘×“ â–¡ ×‘×›×œ ×¢×ª

×ª×•×“×” ×œ×›× ×¢×œ ×”×©×•×ª×¤×•×ª ×•×”×ª××™×›×”! ×™×—×“ ×× ×• ×¢×•×–×¨×™× ×œ×™×œ×“×›×/×™×œ×“×ª×›× ×œ×¤×¨×•×— ×•×œ×’×œ×•×ª ××ª ×”×›×™×©×¨×•× ×•×ª ×”×™×™×—×•×“×™×™× ×©×œ×•/×”.

×‘×‘×¨×›×” ×•×”×¢×¨×›×”,

_________________ - ×× ×˜×•×¨ ××§×¦×•×¢×™
×¢××•×ª×ª ×ª×œ×’×œ×•×ª ××ª ×”××•×¨

×—×ª×™××”: _____________ ×ª××¨×™×š: //______

×“×™×•×•×— ×–×” × ×›×ª×‘ ×‘×™×“×™×“×•×ª ×•×‘×›×‘×•×“ ×¨×‘ ×œ××©×¤×—×ª×›× ×•×œ×™×œ×“×›×/×™×œ×“×ª×›× ×”×™×§×¨/×”
`,
    fileName: '×“×™×•×•×—_×× ×˜×•×¨_×œ××©×¤×—×”.docx' // Changed to .docx
  },
];

function FormsPage() {
  const [currentFormId, setCurrentFormId] = useState(formsData[0].id);
  const currentForm = formsData.find(form => form.id === currentFormId);
  // Removed useRef import and usage, as it's not needed for docx simple text generation


  const handleDownload = async () => {
    if (currentForm) {
      // Create a new Document (representing the DOCX file)
      const doc = new Document({
        sections: [
          {
            properties: {
              // This part of docx library needs to be more specific for RTL
              // Example of setting section properties, including bidi:
              // For full RTL support, you might need to explore more advanced docx properties
              // or ensure your Word program defaults to RTL.
              // For basic text, rightToLeft on TextRun and AlignmentType.RIGHT on Paragraph are key.
            },
            children: currentForm.content.split('\n').map(line =>
              new Paragraph({
                children: [
                  new TextRun({
                    text: line,
                    // Specify font for Hebrew if needed, e.g., "David" or "Arial"
                    // font: "Arial", // Ensure this font is available on the user's system
                    rightToLeft: true, // Crucial for RTL text
                  }),
                ],
                alignment: AlignmentType.RIGHT, // Align paragraph to the right
              })
            ),
          },
        ],
      });

      // Generate the DOCX blob
      const blob = await Packer.toBlob(doc);
      saveAs(blob, currentForm.fileName);
    }
  };

  return (
    <DashboardLayout>
      <div
        className="min-h-screen py-12 px-4 sm:px-6 lg:px-8 relative w-full max-w-7xl mx-auto bg-white rounded-xl shadow-lg overflow-hidden p-8"
        dir="rtl"
      >
          <div className="text-center mb-8">
            <div className="flex items-center justify-center gap-3 mb-2">
              <FileText size={32} className="text-purple-600" />
              <h2 className="text-3xl font-extrabold text-gray-900">×˜×¤×¡×™× ×•×“×•×—×•×ª ×œ×”×•×¨×“×”</h2>
            </div>
            <p className="mt-2 text-sm text-gray-700">×›××Ÿ ×ª×•×›×œ×• ×œ×¦×¤×•×ª ×•×œ×”×•×¨×™×“ ×˜×¤×¡×™× ×©×•× ×™× ×”×§×©×•×¨×™× ×œ×¤×¢×™×œ×•×ª ×”×¢××•×ª×”.</p>
          </div>

          <div className="mb-8 flex flex-wrap justify-center gap-4">
            {formsData.map((form) => (
              <button
                key={form.id}
                onClick={() => setCurrentFormId(form.id)}
                className={`flex items-center gap-2 px-6 py-3 rounded-full text-sm font-semibold transition-all duration-300 ease-in-out
                  ${currentFormId === form.id
                    ? 'bg-purple-600 text-white shadow-md hover:bg-purple-700'
                    : 'bg-gray-100 text-gray-700 hover:bg-gray-200 hover:text-gray-900'
                  }`}
              >
                <FileText size={18} />
                {form.title}
              </button>
            ))}
          </div>

          {currentForm ? (
            <div className="border border-gray-200 rounded-lg p-6 bg-gray-50 shadow-inner">
              <div className="flex justify-between items-center mb-6 pb-4 border-b border-gray-200">
                <h3 className="text-2xl font-bold text-gray-800">{currentForm.title}</h3>
                <button
                  onClick={handleDownload}
                  className="flex items-center gap-2 px-5 py-2 bg-indigo-500 text-white rounded-lg shadow-md hover:bg-indigo-600 transition-colors duration-300"
                >
                  <Download size={20} />
                  ×”×•×¨×“ ××¡××š
                </button>
              </div>

              <div
                // Removed ref={contentRef} as it's not needed for docx simple text generation
                className="prose prose-sm max-w-none text-gray-800 leading-relaxed whitespace-pre-wrap"
                style={{ overflowWrap: 'break-word', wordBreak: 'break-word' }}
              >
                {currentForm.content}
              </div>
            </div>
          ) : (
            <div className="text-center py-12 text-gray-600">
              <FileText size={48} className="mx-auto mb-4 text-gray-400" />
              <p className="text-xl font-medium">×× × ×‘×—×¨ ×˜×•×¤×¡ ×œ×¦×¤×™×™×”</p>
            </div>
          )}
      </div>
    </DashboardLayout>
  );
}

export default FormsPage;
